{% extends "dashboard/roles/caissier/base_caissier.html" %}
{% load static %}

{% block title %}Aide & Support - Caissier - Walee{% endblock %}

{% block dashboard_content %}
<div x-data="aideData()" x-init="init()">
    
    <!-- Header -->
    <div class="mb-6">
        <h1 class="text-3xl font-bold font-poppins text-gray-900 dark:text-white mb-2">
            Aide & Support
        </h1>
        <p class="text-gray-600 dark:text-gray-400">Centre d'aide pour les caissiers</p>
    </div>

    <!-- Recherche -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 mb-6 shadow-sm">
        <div class="relative">
            <i data-lucide="search" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></i>
            <input type="text" 
                   x-model="searchQuery"
                   @input="filterFAQ()"
                   placeholder="Rechercher dans l'aide..."
                   class="w-full pl-12 pr-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg text-lg">
        </div>
    </div>

    <!-- Actions Rapides -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <button @click="contactSupport()" class="p-6 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg hover:shadow-xl transition transform hover:-translate-y-1 text-left">
            <div class="flex items-center space-x-4 text-white">
                <div class="w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center">
                    <i data-lucide="headphones" class="w-7 h-7"></i>
                </div>
                <div>
                    <h3 class="text-lg font-bold">Contacter le Support</h3>
                    <p class="text-sm opacity-90">Assistance en direct</p>
                </div>
            </div>
        </button>

        <button @click="viewTutorials()" class="p-6 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg hover:shadow-xl transition transform hover:-translate-y-1 text-left">
            <div class="flex items-center space-x-4 text-white">
                <div class="w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center">
                    <i data-lucide="play-circle" class="w-7 h-7"></i>
                </div>
                <div>
                    <h3 class="text-lg font-bold">Tutoriels Vidéo</h3>
                    <p class="text-sm opacity-90">Apprendre en vidéo</p>
                </div>
            </div>
        </button>

        <button @click="downloadGuide()" class="p-6 bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg hover:shadow-xl transition transform hover:-translate-y-1 text-left">
            <div class="flex items-center space-x-4 text-white">
                <div class="w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center">
                    <i data-lucide="book-open" class="w-7 h-7"></i>
                </div>
                <div>
                    <h3 class="text-lg font-bold">Guide Utilisateur</h3>
                    <p class="text-sm opacity-90">Documentation PDF</p>
                </div>
            </div>
        </button>
    </div>

    <!-- Raccourcis Clavier -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 mb-6 shadow-sm">
        <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center">
            <i data-lucide="keyboard" class="w-6 h-6 mr-2 text-blue-600"></i>
            Raccourcis Clavier
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                <span class="text-sm text-gray-700 dark:text-gray-300">Scanner produit</span>
                <kbd class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded text-sm font-mono">F2</kbd>
            </div>
            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                <span class="text-sm text-gray-700 dark:text-gray-300">Paiement</span>
                <kbd class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded text-sm font-mono">F12</kbd>
            </div>
            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                <span class="text-sm text-gray-700 dark:text-gray-300">Remise</span>
                <kbd class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded text-sm font-mono">F4</kbd>
            </div>
            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                <span class="text-sm text-gray-700 dark:text-gray-300">Suspendre vente</span>
                <kbd class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded text-sm font-mono">F9</kbd>
            </div>
            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                <span class="text-sm text-gray-700 dark:text-gray-300">Vider panier</span>
                <kbd class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded text-sm font-mono">Esc</kbd>
            </div>
            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                <span class="text-sm text-gray-700 dark:text-gray-300">Aide</span>
                <kbd class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded text-sm font-mono">F1</kbd>
            </div>
        </div>
    </div>

    <!-- FAQ -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm">
        <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center">
            <i data-lucide="help-circle" class="w-6 h-6 mr-2 text-purple-600"></i>
            Questions Fréquentes
        </h2>
        <div class="space-y-3">
            <template x-for="(faq, index) in filteredFAQ" :key="index">
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                    <button @click="toggleFAQ(index)" 
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 transition text-left flex items-center justify-between">
                        <span class="font-semibold text-gray-900 dark:text-white" x-text="faq.question"></span>
                        <i :data-lucide="openFAQ === index ? 'chevron-up' : 'chevron-down'" class="w-5 h-5 text-gray-500"></i>
                    </button>
                    <div x-show="openFAQ === index" 
                         x-transition
                         class="px-4 py-3 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
                        <p class="text-gray-700 dark:text-gray-300" x-text="faq.reponse"></p>
                    </div>
                </div>
            </template>
        </div>
    </div>

</div>
{% endblock %}

{% block extra_js %}
<script>
function aideData() {
    return {
        searchQuery: '',
        openFAQ: null,
        
        faqs: [
            {
                question: "Comment scanner un produit ?",
                reponse: "Utilisez le scanner de code-barres ou tapez le code manuellement dans le champ de recherche puis appuyez sur Entrée. Vous pouvez aussi utiliser le raccourci F2."
            },
            {
                question: "Comment appliquer une remise ?",
                reponse: "Dans le panier, cliquez sur le bouton 'Remise' ou appuyez sur F4. Vous pouvez appliquer une remise globale ou par article."
            },
            {
                question: "Comment suspendre une vente ?",
                reponse: "Cliquez sur le bouton 'Suspendre' ou appuyez sur F9. La vente sera mise en attente et vous pourrez la reprendre plus tard."
            },
            {
                question: "Que faire en cas d'erreur de scan ?",
                reponse: "Si un produit est scanné par erreur, cliquez sur l'icône de suppression (poubelle) à côté de l'article dans le panier."
            },
            {
                question: "Comment clôturer ma session ?",
                reponse: "Allez dans 'Ma Session' et cliquez sur 'Clôturer la Session'. Vous devrez compter le montant en caisse et confirmer."
            },
            {
                question: "Comment imprimer un ticket de caisse ?",
                reponse: "Après validation du paiement, le ticket s'imprime automatiquement. Vous pouvez aussi réimprimer depuis 'Mes Ventes'."
            },
            {
                question: "Comment gérer les paiements multiples ?",
                reponse: "Actuellement, un seul mode de paiement est accepté par transaction. Pour les paiements mixtes, contactez votre superviseur."
            },
            {
                question: "Que faire si le système est lent ?",
                reponse: "Vérifiez votre connexion internet. Si le problème persiste, contactez le support technique via le bouton 'Contacter le Support'."
            },
            {
                question: "Comment ajouter un nouveau client ?",
                reponse: "Allez dans 'Clients' puis cliquez sur 'Nouveau Client'. Remplissez les informations et validez."
            },
            {
                question: "Comment annuler une vente ?",
                reponse: "Une fois validée, une vente ne peut pas être annulée directement. Contactez votre superviseur pour un remboursement."
            }
        ],
        
        get filteredFAQ() {
            if (!this.searchQuery) return this.faqs;
            
            const query = this.searchQuery.toLowerCase();
            return this.faqs.filter(faq => 
                faq.question.toLowerCase().includes(query) ||
                faq.reponse.toLowerCase().includes(query)
            );
        },
        
        init() {
            lucide.createIcons();
        },
        
        toggleFAQ(index) {
            this.openFAQ = this.openFAQ === index ? null : index;
            this.$nextTick(() => lucide.createIcons());
        },
        
        filterFAQ() {
            this.openFAQ = null;
        },
        
        contactSupport() {
            alert('📞 CONTACTER LE SUPPORT\n\n' +
                  'Téléphone: +225 27 20 00 00\n' +
                  'Email: support@walee.ci\n' +
                  'WhatsApp: +225 07 00 00 00\n\n' +
                  'Horaires: Lun-Ven 8h-18h');
        },
        
        viewTutorials() {
            alert('🎥 TUTORIELS VIDÉO\n\n' +
                  '1. Prise en main du POS\n' +
                  '2. Gestion des ventes\n' +
                  '3. Clôture de session\n' +
                  '4. Gestion des clients\n\n' +
                  'Accédez aux vidéos sur: videos.walee.ci');
        },
        
        downloadGuide() {
            alert('📚 GUIDE UTILISATEUR\n\n' +
                  'Téléchargement du guide PDF en cours...\n\n' +
                  'Le guide complet du caissier sera téléchargé.');
        }
    }
}
</script>
{% endblock %}
